<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BASSLINE">
<title>Introduction to BASSLINE • BASSLINE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BASSLINE">
<meta property="og:description" content="BASSLINE">
<meta property="og:image" content="https://www.constantine-cooke.com/BASSLINE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BASSLINE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9010</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/BASSLINE.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.constantine-cooke.com" aria-label="Personal website">Constantine-Cooke.com</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nathansam/BASSLINE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="BASSLINE_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to BASSLINE</h1>
                        <h4 data-toc-skip class="author">Nathan Constantine-Cooke</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:nathan.constantine-cooke@ed.ac.uk" class="email">nathan.constantine-cooke@ed.ac.uk</a>
      
                              <h4 data-toc-skip class="author">Catalina Vallejos</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:catalina.vallejos@igmm.ed.ac.uk" class="email">catalina.vallejos@igmm.ed.ac.uk</a>
      
                  
            <h4 data-toc-skip class="date">2022-05-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nathansam/BASSLINE/blob/HEAD/vignettes/BASSLINE.Rmd" class="external-link"><code>vignettes/BASSLINE.Rmd</code></a></small>
      <div class="d-none name"><code>BASSLINE.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.constantine-cooke.com/BASSLINE/">BASSLINE</a></span><span class="op">)</span></code></pre></div>
<p>BASSLINE (<strong>BA</strong>ye<strong>S</strong>ian <strong>S</strong>urvival ana<strong>L</strong>ys<strong>I</strong>s usi<strong>N</strong>g shap<strong>E</strong> mixtures of log-normal distributions) uses shape mixtures of log-normal distributions to fit data with fat tails and has been adapted from code produced for <em>Objective Bayesian Survival Analysis Using Shape Mixtures of Log-Normal </em>Distributions <span class="citation">(Vallejos and Steel 2015)</span>. Some of the functions have been rewritten in C++ for increased performance.</p>
<p>5 distributions from the log-normal family are supported by <code>BASSLINE</code>:</p>
<ul>
<li>The log-normal distribution</li>
<li>The log student’s T distribution</li>
<li>The log-logistic distribution</li>
<li>The log-Laplace distribution</li>
<li>The log-exponential power distribution</li>
</ul>
<p>As well as MCMC (Markov chain Monte Carlo) algorithms for the 5 distributions, additional functions which allow log-marginal likelihood estimators and deviance information criteria to be calculated are provided. Case deletion analysis and outlier detection are also supported.</p>
<p>This vignette demonstrates how to use the <code>BASSLINE</code> package to carry out survival analysis using the included <code>cancer</code> data-set from the veterans administration lung cancer trial.</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Essential parameters for running the MCMC are :</p>
<ul>
<li>
<code>N</code>: total number of iterations</li>
<li>
<code>thin</code>: length of the thinning period (i.e. only every <code>thin</code> iterations will be stored in the output)</li>
<li>
<code>burn</code>: length of burn-in period (i.e. the initial <code>burn</code> iterations that will be discarded from the output)</li>
<li>
<code>Time</code>: Vector of survival times</li>
<li>
<code>Cens</code>: Vector indicating if observations are censored</li>
<li>
<code>X</code>: Matrix of covariates for each observation</li>
</ul>
<p>Starting values for the <span class="math inline">\(\beta\)</span>s and <span class="math inline">\(\sigma^2\)</span> are randomly sampled from an appropriate distribution if not given by the user as arguments. Additional arguments allow the type of prior to be specified, and the observations to be specified as set or point observations. See the documentation for any of the MCMC functions included with <code>BASSLINE</code> for more information on these additional arguments.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="fu"><a href="../reference/MCMC_LN.html">MCMC_LN</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Note that BASSLINE does not support factors/ levels. Factors should be converted to separate binary variables for each level which can be easily done via the provided <code>BASSLINE_convert</code> function. For example:</p>
<table class="table">
<thead><tr class="header">
<th align="right">Time</th>
<th align="right">Cens</th>
<th align="left">treatment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">1</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1</td>
<td align="left">B</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">0</td>
<td align="left">C</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1</td>
<td align="left">A</td>
</tr>
</tbody>
</table>
<p>can be converted by simply passing the dataframe object to the function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">converted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BASSLINE_convert.html">BASSLINE_convert</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Time</th>
<th align="right">Cens</th>
<th align="right">treatment.A</th>
<th align="right">treatment.B</th>
<th align="right">treatment.C</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="the-cancer-data-set">The Cancer Data Set<a class="anchor" aria-label="anchor" href="#the-cancer-data-set"></a>
</h2>
<p>Included with <code>BASSLINE</code> is an example data set, <code>cancer</code>. This data has been obtained from a study conducted by the US Veterans Administration where male patients with advanced inoperable lung cancer were given either standard or experimental chemotherapy treatment <span class="citation">(Kalbfleisch and Prentice 2002)</span>. 137 patients took part in the trial, 9 of whom left the study before their death and are thus right censored. Various covariates were also documented for each patient.</p>
<p>Viewing the first 5 observations shows the data set’s format:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cancer</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Time</th>
<th align="right">Cens</th>
<th align="right">Intercept</th>
<th align="right">Treat</th>
<th align="right">Type.1</th>
<th align="right">Type.2</th>
<th align="right">Type.3</th>
<th align="right">Status</th>
<th align="right">MFD</th>
<th align="right">Age</th>
<th align="right">Prior</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">72</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">60</td>
<td align="right">7</td>
<td align="right">69</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">411</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">70</td>
<td align="right">5</td>
<td align="right">64</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">228</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">60</td>
<td align="right">3</td>
<td align="right">38</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">126</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">60</td>
<td align="right">9</td>
<td align="right">63</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">118</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">70</td>
<td align="right">11</td>
<td align="right">65</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The first column of <code>cancer</code> denotes the survival time for the observation. The second column denotes the censored status for the observation (0 for right censored; 1 for not censored ). All remaining columns are covariates. Additional information can be found in the documentation for <code>cancer</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">cancer</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Time</span> <span class="op">&lt;-</span> <span class="va">cancer</span><span class="op">[</span>,<span class="st">"Time"</span><span class="op">]</span>
<span class="va">Cens</span> <span class="op">&lt;-</span> <span class="va">cancer</span><span class="op">[</span>,<span class="st">"Cens"</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mcmc-chains">MCMC chains<a class="anchor" aria-label="anchor" href="#mcmc-chains"></a>
</h2>
<p>MCMC chains can be easily generated by providing the aforementioned essential parameters. As previous discussed, starting values are randomly sampled if not provided by the user. The user will possibly obtain improved results from experimenting with these starting values.</p>
<p>Please note N = 1000, as used in these examples, is not enough to reach convergence and is only used as a demonstration. The user is advised to run longer chains with a longer burn-in period for more accurate estimations (especially for the log-exponential power model).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Log-normal</span>
<span class="va">LN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LN.html">MCMC_LN</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span>, Time <span class="op">=</span> <span class="va">Time</span>,
              Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : -0.18 </span>
<span class="co">#&gt;  Initial beta 2 : 2.49 </span>
<span class="co">#&gt;  Initial beta 3 : -0.43 </span>
<span class="co">#&gt;  Initial beta 4 : 1.55 </span>
<span class="co">#&gt;  Initial beta 5 : -0.42 </span>
<span class="co">#&gt;  Initial beta 6 : 0.03 </span>
<span class="co">#&gt;  Initial beta 7 : -0.92 </span>
<span class="co">#&gt;  Initial beta 8 : -1.37 </span>
<span class="co">#&gt;  Initial beta 9 : 1.16 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 0.56</span>

<span class="co"># Log-student's T</span>
<span class="va">LST</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LST.html">MCMC_LST</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span> , Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>,
                X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : -0.27 </span>
<span class="co">#&gt;  Initial beta 2 : -1.49 </span>
<span class="co">#&gt;  Initial beta 3 : 0.68 </span>
<span class="co">#&gt;  Initial beta 4 : 0.01 </span>
<span class="co">#&gt;  Initial beta 5 : 1.36 </span>
<span class="co">#&gt;  Initial beta 6 : 1.46 </span>
<span class="co">#&gt;  Initial beta 7 : 0.18 </span>
<span class="co">#&gt;  Initial beta 8 : -2 </span>
<span class="co">#&gt;  Initial beta 9 : 0.9 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 0.12 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial nu from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial nu : 0.31 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AR nu : 0.36</span>

<span class="co"># Log-Laplace</span>
<span class="va">LLAP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LLAP.html">MCMC_LLAP</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span>,  Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>,
                  X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : -0.33 </span>
<span class="co">#&gt;  Initial beta 2 : -0.08 </span>
<span class="co">#&gt;  Initial beta 3 : -0.39 </span>
<span class="co">#&gt;  Initial beta 4 : 0.98 </span>
<span class="co">#&gt;  Initial beta 5 : 1.17 </span>
<span class="co">#&gt;  Initial beta 6 : 0.05 </span>
<span class="co">#&gt;  Initial beta 7 : 1.18 </span>
<span class="co">#&gt;  Initial beta 8 : 0.44 </span>
<span class="co">#&gt;  Initial beta 9 : -1.22 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 0.16</span>

<span class="co">#Log-exponential power</span>
<span class="va">LEP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LEP.html">MCMC_LEP</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span>, Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>,
                X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : -1.9 </span>
<span class="co">#&gt;  Initial beta 2 : -1.43 </span>
<span class="co">#&gt;  Initial beta 3 : -0.02 </span>
<span class="co">#&gt;  Initial beta 4 : -0.46 </span>
<span class="co">#&gt;  Initial beta 5 : 0.86 </span>
<span class="co">#&gt;  Initial beta 6 : -0.81 </span>
<span class="co">#&gt;  Initial beta 7 : 2.4 </span>
<span class="co">#&gt;  Initial beta 8 : -1.76 </span>
<span class="co">#&gt;  Initial beta 9 : -0.94 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 2.5 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial alpha from a Uniform(1, 2) distribution</span>
<span class="co">#&gt; Initial alpha : 1.78 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AR beta 1 : 0.52 </span>
<span class="co">#&gt;  AR beta 2 : 0.63 </span>
<span class="co">#&gt;  AR beta 3 : 0.73 </span>
<span class="co">#&gt;  AR beta 4 : 0.69 </span>
<span class="co">#&gt;  AR beta 5 : 0.76 </span>
<span class="co">#&gt;  AR beta 6 : 0.02 </span>
<span class="co">#&gt;  AR beta 7 : 0.07 </span>
<span class="co">#&gt;  AR beta 8 : 0.03 </span>
<span class="co">#&gt;  AR beta 9 : 0.69 </span>
<span class="co">#&gt; AR sigma2 : 0.92 </span>
<span class="co">#&gt; AR alpha : 0.12</span>

<span class="co">#Log-logistic</span>
<span class="va">LLOG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LLOG.html">MCMC_LLOG</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span>, Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>,
                  X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : 0.62 </span>
<span class="co">#&gt;  Initial beta 2 : -0.5 </span>
<span class="co">#&gt;  Initial beta 3 : -0.18 </span>
<span class="co">#&gt;  Initial beta 4 : 0.13 </span>
<span class="co">#&gt;  Initial beta 5 : -0.79 </span>
<span class="co">#&gt;  Initial beta 6 : 0.86 </span>
<span class="co">#&gt;  Initial beta 7 : -0.54 </span>
<span class="co">#&gt;  Initial beta 8 : 1.5 </span>
<span class="co">#&gt;  Initial beta 9 : 2.18 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 0.65</span></code></pre></div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p>After generating MCMC chains, their suitability should be assessed. This can be done, in part, via the <code>Trace_Plot</code> function included with <code>BASSLINE</code> which will plot a chain for a variable across (non-discarded) iterations. We will investigate the chain for <span class="math inline">\(\beta_1\)</span> from the log-normal model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/Trace_plot.html">Trace_plot</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">LN</span><span class="op">)</span></code></pre></div>
<p><img src="BASSLINE_files/figure-html/Trace%20Plot-1.png" width="700"></p>
<p>For additional analysis of chains, the <code>coda</code> package is recommended which offers many different functions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">as.mcmc</a></span><span class="op">(</span><span class="va">LN</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="BASSLINE_files/figure-html/ACF%20plot-1.png" width="700"><img src="BASSLINE_files/figure-html/ACF%20plot-2.png" width="700"><img src="BASSLINE_files/figure-html/ACF%20plot-3.png" width="700"><img src="BASSLINE_files/figure-html/ACF%20plot-4.png" width="700"></p>
<p>ACF plots are also available via <code>coda</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/coda/man/trellisplots.html" class="external-link">acfplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">as.mcmc</a></span><span class="op">(</span><span class="va">LN</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="BASSLINE_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="deviance-information-criterion">Deviance Information Criterion<a class="anchor" aria-label="anchor" href="#deviance-information-criterion"></a>
</h2>
<p>The deviance information criterion (DIC), a hierarchical modeling generalization of the Akaike information criterion <span class="citation">(Spiegelhalter et al. 2002)</span>, can be easily calculated for the 5 models.</p>
<p>If the deviance is defined as</p>
<p><span class="math display">\[D\left(\theta, y\right) = -2 \log\left(f\left(y|\theta\right)\right)\]</span></p>
<p>then</p>
<p><span class="math display">\[ DIC = D\left(\bar{\theta}\right) + 2p_D \]</span></p>
<p>Where <span class="math inline">\(p_D\)</span> is the number of effective parameters.</p>
<p>Each member of the log-normal family has a function to calculate DIC. We will present an example using the log-normal distribution and compare two models with differing covariates (all of the available covariates vs. only the last 4 covariates).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LN.html">MCMC_LN</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span>, Time <span class="op">=</span> <span class="va">Time</span>,
              Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : -0.62 </span>
<span class="co">#&gt;  Initial beta 2 : 0.87 </span>
<span class="co">#&gt;  Initial beta 3 : -1.14 </span>
<span class="co">#&gt;  Initial beta 4 : 0.58 </span>
<span class="co">#&gt;  Initial beta 5 : -1.17 </span>
<span class="co">#&gt;  Initial beta 6 : -0.76 </span>
<span class="co">#&gt;  Initial beta 7 : -0.21 </span>
<span class="co">#&gt;  Initial beta 8 : 0.12 </span>
<span class="co">#&gt;  Initial beta 9 : 1.22 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 5.14</span>
<span class="fu"><a href="../reference/DIC_LN.html">DIC_LN</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, chain <span class="op">=</span> <span class="va">LN</span><span class="op">)</span>
<span class="co">#&gt; Effective number of parameters : 10.14 </span>
<span class="co">#&gt; Actual number of parameters : 10</span>
<span class="co">#&gt; [1] 1450.872</span>

<span class="co"># Reduced model</span>
<span class="va">LN.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MCMC_LN.html">MCMC_LN</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, thin <span class="op">=</span> <span class="fl">20</span>, burn <span class="op">=</span> <span class="fl">40</span>, Time <span class="op">=</span> <span class="va">Time</span>,
              Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Sampling initial betas from a Normal(0, 1) distribution</span>
<span class="co">#&gt; Initial beta 1 : -1.16 </span>
<span class="co">#&gt;  Initial beta 2 : 0.91 </span>
<span class="co">#&gt;  Initial beta 3 : 1.01 </span>
<span class="co">#&gt;  Initial beta 4 : 0.29 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling initial sigma^2 from a Gamma(2, 2) distribution</span>
<span class="co">#&gt; Initial sigma^2 : 1.14</span>
<span class="fu"><a href="../reference/DIC_LN.html">DIC_LN</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, chain <span class="op">=</span> <span class="va">LN.2</span><span class="op">)</span>
<span class="co">#&gt; Effective number of parameters : 4.89 </span>
<span class="co">#&gt; Actual number of parameters : 5</span>
<span class="co">#&gt; [1] 1455.262</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="log-marginal-likelihood">Log-Marginal Likelihood<a class="anchor" aria-label="anchor" href="#log-marginal-likelihood"></a>
</h2>
<p>The log-marginal likelihood is given by:</p>
<p><span class="math display">\[ \log\left(m\left(t\right)\right) = 
\log\left(  
\int_{-\infty}^{\infty}
\int_{0}^{\infty}
\int_\Theta 
f\left(t \mid \beta, \sigma^2, \theta \right)
\pi\left(\beta, \sigma^2, \theta\right)
d\beta \: d\sigma^2 \: d\theta \right)\]</span></p>
<p>And can be easily estimated using the supplied function for each distribution which is based on the work of Chib <span class="citation">(Chib 1995)</span> and Chib and Jeliaskov <span class="citation">(Chib and Jeliazkov 2001)</span>. The function will return a list which includes the log-marginal likelihood estimation, the log-likelihood ordinate, the log-prior ordinate, and the log-posterior ordinates. Messages detailing the progress of the algorithm are provided to the user.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/LML_LN.html">LML_LN</a></span><span class="op">(</span>thin <span class="op">=</span> <span class="fl">20</span>, <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, chain <span class="op">=</span> <span class="va">LN</span><span class="op">)</span> 
<span class="co">#&gt; Likelihood ordinate ready!</span>
<span class="co">#&gt; Prior ordinate ready!</span>
<span class="co">#&gt; Posterior ordinate sigma2 ready!</span>
<span class="co">#&gt; Posterior ordinate beta ready!</span>
<span class="co">#&gt; $LL.ord</span>
<span class="co">#&gt; [1] -715.292</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LP.ord</span>
<span class="co">#&gt; [1] -0.2479007</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LPO.sigma2</span>
<span class="co">#&gt; [1] 0.8444352</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LPO.beta</span>
<span class="co">#&gt; [1] 15.63174</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LML</span>
<span class="co">#&gt; [1] -732.016</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="leave-one-out-cross-validation-analysis">Leave-One-Out Cross-Validation Analysis<a class="anchor" aria-label="anchor" href="#leave-one-out-cross-validation-analysis"></a>
</h2>
<p>Leave-one-out cross-validation analysis is also available for all 5 of the supported distributions. The functions returns matrices with <span class="math inline">\(n\)</span> rows.</p>
<p>Its first column contains the logarithm of the conditional predictive ordinate (CPO) <span class="citation">(Geisser and Eddy 1979)</span>. Larger values of the CPO indicate better predictive accuracy.</p>
<p>The second and third columns contain the Kullback–Leibler (KL) divergence between <span class="math display">\[ \pi\left(\beta, \sigma^2, \theta \mid t_{-i}\right)\]</span> and <span class="math display">\[ \pi\left(\beta, \sigma^2, \theta \mid t\right)\]</span> and its calibration index <span class="math inline">\(p_i\)</span> <span class="citation">(Cho et al. 2008)</span> respectively. The later is used in order to evaluate the existence of influential observations. If <span class="math inline">\(p_i\)</span> is substantially larger than 0.5, observation <span class="math inline">\(i\)</span> is declared influential. Suggested cut-off values are 0.8 and 0.9.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LN.CD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CaseDeletion_LN.html">CaseDeletion_LN</a></span><span class="op">(</span><span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>, X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, chain <span class="op">=</span> <span class="va">LN</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">LN.CD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">logCPO</th>
<th align="right">KL</th>
<th align="right">CALIBRATION</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">-5.458756</td>
<td align="right">0.0098535</td>
<td align="right">0.5698464</td>
</tr>
<tr class="even">
<td align="right">-7.521398</td>
<td align="right">0.0329260</td>
<td align="right">0.6262245</td>
</tr>
<tr class="odd">
<td align="right">-6.957001</td>
<td align="right">0.0352064</td>
<td align="right">0.6303754</td>
</tr>
<tr class="even">
<td align="right">-5.928877</td>
<td align="right">0.0033992</td>
<td align="right">0.5411561</td>
</tr>
<tr class="odd">
<td align="right">-5.874741</td>
<td align="right">0.0052567</td>
<td align="right">0.5511332</td>
</tr>
</tbody>
</table>
<p>It is sensible to report the number of observations which are deemed influential for a given cutoff which can be easily found by the user.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">LN.CD</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="co">#&gt; [1] 3</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="outlier-detection">Outlier Detection<a class="anchor" aria-label="anchor" href="#outlier-detection"></a>
</h2>
<p>Outlier detection is available for a specified observation (obs) for the log-student’s T, log-Laplace, log-logistic, log-exponential power models. This returns a unique number corresponding to the Bayes Factor associated with the test <span class="math inline">\(M_0 : \Lambda_\text{obs} = \lambda_\text{ref}\)</span> versus <span class="math inline">\(M_0 : \Lambda_\text{obs} \neq \lambda_\text{ref}\)</span> (with all other <span class="math inline">\(\Lambda_j, j \neq \text{obs}\)</span> free). The value of <span class="math inline">\(\lambda_\text{ref}\)</span> is required as input.</p>
<p>The recommended value of <span class="math inline">\(\lambda_\text{ref}\)</span> is 1 with the exception of the log-logistic model where we recommend 0.4 instead. The calculations which support these recommendations can be found in the original paper <span class="citation">(Vallejos and Steel 2015)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">OD.LST</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span> <span class="op">:</span> <span class="fl">5</span><span class="op">)</span>
<span class="op">{</span>
    <span class="va">OD.LST</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BF_lambda_obs_LST.html">BF_lambda_obs_LST</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, thin <span class="op">=</span> <span class="fl">20</span> , burn <span class="op">=</span> <span class="fl">1</span>, ref <span class="op">=</span> <span class="fl">1</span>,
                                   obs <span class="op">=</span> <span class="va">i</span>, Time <span class="op">=</span> <span class="va">Time</span>, Cens <span class="op">=</span> <span class="va">Cens</span>,
                                   X <span class="op">=</span> <span class="va">cancer</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, chain <span class="op">=</span> <span class="va">LST</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; AR nu : 0.36 </span>
<span class="co">#&gt; AR nu : 0.39 </span>
<span class="co">#&gt; AR nu : 0.33 </span>
<span class="co">#&gt; AR nu : 0.38 </span>
<span class="co">#&gt; AR nu : 0.33</span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-chib">
<p>Chib, Siddhartha. 1995. “Marginal Likelihood from the Gibbs Output.” <em>Journal of the American Statistical Association</em> 90 (432): 1313–21. <a href="https://doi.org/10.1080/01621459.1995.10476635" class="external-link">https://doi.org/10.1080/01621459.1995.10476635</a>.</p>
</div>
<div id="ref-chib2">
<p>Chib, Siddhartha, and Ivan Jeliazkov. 2001. “Marginal Likelihood from the Metropolis–Hastings Output.” <em>Journal of the American Statistical Association</em> 96 (453): 270–81. <a href="https://doi.org/10.1198/016214501750332848" class="external-link">https://doi.org/10.1198/016214501750332848</a>.</p>
</div>
<div id="ref-CI">
<p>Cho, Hyunsoon, Joseph G. Ibrahim, Debajyoti Sinha, and Hongtu Zhu. 2008. “Bayesian Case Influence Diagnostics for Survival Models.” <em>Biometrics</em> 65 (1): 116–24. <a href="https://doi.org/10.1111/j.1541-0420.2008.01037.x" class="external-link">https://doi.org/10.1111/j.1541-0420.2008.01037.x</a>.</p>
</div>
<div id="ref-cpo">
<p>Geisser, Seymour, and William F. Eddy. 1979. “A Predictive Approach to Model Selection.” <em>Journal of the American Statistical Association</em> 74 (365): 153–60. <a href="https://doi.org/10.1080/01621459.1979.10481632" class="external-link">https://doi.org/10.1080/01621459.1979.10481632</a>.</p>
</div>
<div id="ref-VACancerTrial">
<p>Kalbfleisch, John D., and Ross L. Prentice. 2002. <em>The Statistical Analysis of Failure Time Data</em>. John Wiley &amp; Sons, Inc. <a href="https://doi.org/10.1002/9781118032985" class="external-link">https://doi.org/10.1002/9781118032985</a>.</p>
</div>
<div id="ref-DIC">
<p>Spiegelhalter, David J., Nicola G. Best, Bradley P. Carlin, and Angelika Van Der Linde. 2002. “Bayesian Measures of Model Complexity and Fit.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 64 (4): 583–639. <a href="https://doi.org/10.1111/1467-9868.00353" class="external-link">https://doi.org/10.1111/1467-9868.00353</a>.</p>
</div>
<div id="ref-Vallejos2015">
<p>Vallejos, Catalina A., and Mark F. J. Steel. 2015. “Objective Bayesian Survival Analysis Using Shape Mixtures of Log-Normal Distributions.” <em>Journal of the American Statistical Association</em> 110 (510): 697–710. <a href="https://doi.org/10.1080/01621459.2014.923316" class="external-link">https://doi.org/10.1080/01621459.2014.923316</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Catalina Vallejos, Nathan Constantine-Cooke.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
